# [Final] 스마트 팩토리 프로젝트
## 기획목적
**Edukit으로 디지털 트윈 실시간 모니터링 시스템 구축**
<img src="img/KakaoTalk.gif"/>
<br />


## 기획 아이디어
산업 분야로 옮겨진 메타버스 및 디지털 트윈을 통해 기존의 자동화된 기기 관리를 웹 UI UX로 구현하고, 구현한 기기의 실시간 데이터 확인 및 불량품 판독을 가능하게 하여 기기 관리자로 하여금 기기제어 및 생산품 관리가 용이하도록 했습니다.


## 프로세스 구조도
- **회원가입 & 로그인**
<br />
<img src="img/auth.png"/>


- **로그인 이후**
<br />
<img src="img/login-after.png"/>


- **개인정보 및 권한 부여**
<br />
<img src="img/NavBar-info.png"/>


- **디바이스 모니터링**
<br />
<img src="img/NavBar-monitoring.png"/>


- **Edukit 데이터 플로우**
<br />
<img src="img/Edukit-data-flow.png"/>

- **Smartfactory 플로우**
<br />
<img src="img/SmartFactory.png"/>


## 프로젝트 방법 및 과정
#### **기능명세**
**기기 실시간 확인 및 제어**
- edukit의 실시간 데이터를 three.js로 웹에서 확인 가능
- 비상정지, 리셋, 시작 등의 제어가 가능
- 상자의 색깔을 구별하여 불량품을 구별 가능
- 주사위의 숫자를 판별하여 생산한 상품 종류 확인

**실시간 데이터 확인 대시보드**
- 실시간 데이터들을 three.js로 디지털 트윈 3D 모델과 함께 chart.js로 표시
- DB에 저장되는 데이터들은 Grafana로 임베딩하여 프론트에서 구현
- 빨간색의 상자일 경우 불량품으로 간주
- main 화면에서 주사위(상품 종류) 숫자 확인
- 마이페이지는 사용자 정보 확인 및 수정이 가능

**실시간 데이터 항목 예시**
- 휘발성 / 비휘발성 데이터로 나눔
- 휘발성 예시 : 불량 비율 값 도넛 그래프, 재고 현황, 신호등 색깔, PLC 상태
- 비휘발성 예시 : 하루 총 생산량, 상품별 생산량, 양품&불량품 비율


## 기능 구현 방법
#### **프론트엔드**
- 프론트 화면은 Vue.js로 구현
- 3D 모델은 three.js로 구현
- 대시보드 그래프는 chart.js와 Grafana로 구현

#### **백엔드**
- 백엔드 서버는 Node.js로 구현

#### **IoT/PLC**
- 데이터 수집은 mqtt로 구현

#### **Infra**
- 코드는 GitHub Repository로 관리
- Jira의 스크럼 방식으로 프로젝트 일정 및 진행상황 관리
- Jira의 버그 캐치 방식으로 실시간 이슈에 대한 관리
- 진행상황마다 구조도를 그려서 프로젝트에 대한 이해도 확인


## 프로젝트 상세
#### **요구사항 리스트**
1. 사용자 - 로그인 / 회원가입 / 사용자 정보
2. 대시보드 - 데이터 시각화(휘발성 & 비휘발성)
3. 디지털트윈 - edukit과의 연결 / 작업 상황 실시간 확인 / 비상시 작업 제어
<br />

#### **요구사항 분석**
- **회원가입**
  - 회원가입 시에 이름, 직급, 비밀번호, 아이디를 필수적으로 입력하도록 한다.
  - 입력한 아이디에 대한 중복확인을 한다.
  - 이메일 인증을 통해 보안과 무분별한 가입을 제지한다.
  - 회원가입 성공 시에 DB에 저장한다.
  - DB에 저장한 비밀번호는 해시암호화 되어야 한다.
<br />

- **로그인**
  - 로그인 시에 아이디, 비밀번호를 입력한다.
  - 입력한 아이디와 비밀번호가 DB와 일치하면 메인 화면으로 넘긴다.
  - 로그인 성공 시에 토큰을 부여하며, 토큰은 아이디와 이름, 역할이 담겨 있다.
<br />

- **디바이스 선택 & 추가**
  - 관리자가 로그인한 유저에게 권한을 부여한 디바이스 리스트를 화면에 띄운다. 만약 관리자가 로그인을 했다면 모든 디바이스 리스트를 띄운다.
  - 로그인한 유저가 관리자라면 디바이스 추가 버튼을 통해 새로운 디바이스를 만들 수 있다.
  - 디바이스 리스트 중 하나를 선택해 들어가면 등록 된 PLC id params로 이동할 수 있다.
  <br />

- **Edukit 3D 모델링**
  - 3D 모델링 화면으로 이동할 때 mqtt를 자동으로 연결되게 만든다.
  - 연결한 데이터를 기반으로 3D환경의 edukit을 웹에 표시한다.
  - 일시정지, 리셋, 시작 버튼을 구현한다.
  - 각 버튼을 누르면 edukit에 실시간으로 데이터가 전송된다.
  - 전송된 데이터를 기반으로 edukit을 제어한다.
  <br />

- **대시보드**
  - mqtt로 받은 데이터를 정제한다.
  - 정제한 데이터들 중에서 모니터링 데이터들을 chart.js로 뿌려준다.
  - 한 사이클이 돌아 DB에 저장되는 생산품 데이터들은  Grafana로 보여준다.